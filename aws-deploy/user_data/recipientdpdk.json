[
    "#!/bin/bash -xe\n",
    "cd home/ubuntu\n",
    "# >>>>we can later remove rm/mkdir when the image is configured accordingly\n",
    "sudo rm -rf dom-tenant-service/\n",
    "sudo mkdir dom-tenant-service/\n",
    "sudo chmod 777 dom-tenant-service/ \n",
    "sudo chown -R root:root ./dom-tenant-service\n",
    "aws s3 cp s3://BKT_NAME/bundled_proj.tar.gz .\n",
    "tar -xzf bundled_proj.tar.gz -C dom-tenant-service/\n",
    "export HOME=/root\n",
    "cat /sys/class/net/ens6/address > mac.txt\n",
    "cat /sys/class/net/ens5/address > macsocket.txt\n",
    "ip -o -4 addr show dev ens6 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\n",
    "ip -o -4 addr show dev ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n",
    "cd ./dom-tenant-service/\n",
    "cd src/kernel_modules/igb_uio\n",
    "ip link set dev ens6 down\n",
    "# sysctl -w vm.nr_hugepages=5000\n",
    "sudo ./install.sh || sudo ./install.sh\n",
    "cd ../../../../dpdk-stable*\n",
    "sudo ./usertools/dpdk-devbind.py --bind=igb_uio 00:06.0\n",
    "sudo ./usertools/dpdk-devbind.py --status\n",
    "cd ../dom-tenant-service/\n",
    "cd aws-deploy\n",
    "sudo chmod +x ./stats_to_s3.sh\n",
    "sudo chmod +x ./deploy_ttcs.sh\n",
    "sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg IP_ADDR\n",
    "cd ..\n",
    "cp ./../mac.txt ./config/mac.txt\n",
    "cp ./../macsocket.txt ./config/macsocket.txt\n",
    "cp ./../ip.txt ./config/ip.txt\n",
    "cp ./../ipsocket.txt ./config/ipsocket.txt\n",
    "cd ./src\n",
    "# sudo ip link set dev ens5 mtu 3498\n",
    "# sudo ethtool -L ens5 combined 1\n",
    "clang -g -O2 -Wall -target bpf -I ~/iproute2/include/ -c ./multicast_receiver/xdp-deduplication.c -o xdp-deduplication.o\n",
    "make multicast_receivers\n",
    "./build/multicast_receivers INSTANCE_NUM DUPLICATION_FACTOR RUN_MODE BRANCHING_FACTOR REDUNDANCY_FACTOR TOTAL_NON_REDUNDANT_PROXIES\n"
]