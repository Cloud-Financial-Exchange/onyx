[
    "#!/bin/bash -xe\n",
    "cd home/ubuntu\n",
    "# sudo apt-get update -y\n",
    "# sudo apt install cargo -y\n",
    "# >>>>we can later remove rm/mkdir when the image is configured accordingly\n",
    "sudo rm -rf dom-tenant-service/\n",
    "sudo mkdir dom-tenant-service/\n",
    "sudo chmod 777 dom-tenant-service/ \n",
    "sudo chown -R root:root ./dom-tenant-service\n",
    "aws s3 cp s3://BKT_NAME/bundled_proj.tar.gz .\n",
    "tar -xzf bundled_proj.tar.gz -C dom-tenant-service/\n",
    "export HOME=/root\n",
    "# sudo cp /home/ubuntu/.ssh/id_rsa /root/.ssh/id_rsa\n",
    "# sudo cp /home/ubuntu/.ssh/id_rsa.pub /root/.ssh/id_rsa.pub\n",
    "cat /sys/class/net/ens5/address > mac.txt\n",
    "ip -o -4 addr show dev ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\n",
    "cd dom-tenant-service/\n",
    "cd aws-deploy\n",
    "sudo chmod +x ./stats_to_s3.sh\n",
    "sudo chmod +x ./deploy_ttcs.sh\n",
    "sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg IP_ADDR\n",
    "cd ..\n",
    "cp ./../mac.txt ./config/mac.txt\n",
    "cp ./../ip.txt ./config/ip.txt\n",
    "cd ./src\n",
    "make multicast_receivers\n",
    "./build/multicast_receivers INSTANCE_NUM DUPLICATION_FACTOR RUN_MODE BRANCHING_FACTOR REDUNDANCY_FACTOR TOTAL_NON_REDUNDANT_PROXIES\n"
]