resources:
- name: recipient0060
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.60
      - key: INSTANCE_NUM
        value: '60'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.60
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.60
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0061
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.61
      - key: INSTANCE_NUM
        value: '61'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.61
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.61
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0062
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.62
      - key: INSTANCE_NUM
        value: '62'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.62
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.62
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0063
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.63
      - key: INSTANCE_NUM
        value: '63'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.63
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.63
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0064
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.64
      - key: INSTANCE_NUM
        value: '64'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.64
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.64
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0065
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.65
      - key: INSTANCE_NUM
        value: '65'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.65
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.65
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0066
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.66
      - key: INSTANCE_NUM
        value: '66'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.66
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.66
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0067
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.67
      - key: INSTANCE_NUM
        value: '67'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.67
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.67
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0068
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.68
      - key: INSTANCE_NUM
        value: '68'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.68
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.68
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0069
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.69
      - key: INSTANCE_NUM
        value: '69'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.69
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.69
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0070
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.70
      - key: INSTANCE_NUM
        value: '70'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.70
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.70
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0071
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.71
      - key: INSTANCE_NUM
        value: '71'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.71
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.71
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0072
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.72
      - key: INSTANCE_NUM
        value: '72'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.72
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.72
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0073
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.73
      - key: INSTANCE_NUM
        value: '73'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.73
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.73
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0074
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.74
      - key: INSTANCE_NUM
        value: '74'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.74
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.74
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0075
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.75
      - key: INSTANCE_NUM
        value: '75'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.75
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.75
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0076
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.76
      - key: INSTANCE_NUM
        value: '76'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.76
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.76
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0077
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.77
      - key: INSTANCE_NUM
        value: '77'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.77
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.77
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0078
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.78
      - key: INSTANCE_NUM
        value: '78'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.78
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.78
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0079
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.79
      - key: INSTANCE_NUM
        value: '79'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.79
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.79
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
