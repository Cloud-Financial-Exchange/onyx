resources:
- name: recipient0040
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.40
      - key: INSTANCE_NUM
        value: '40'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.40
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.40
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0041
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.41
      - key: INSTANCE_NUM
        value: '41'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.41
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.41
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0042
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.42
      - key: INSTANCE_NUM
        value: '42'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.42
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.42
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0043
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.43
      - key: INSTANCE_NUM
        value: '43'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.43
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.43
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0044
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.44
      - key: INSTANCE_NUM
        value: '44'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.44
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.44
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0045
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.45
      - key: INSTANCE_NUM
        value: '45'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.45
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.45
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0046
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.46
      - key: INSTANCE_NUM
        value: '46'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.46
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.46
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0047
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.47
      - key: INSTANCE_NUM
        value: '47'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.47
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.47
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0048
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.48
      - key: INSTANCE_NUM
        value: '48'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.48
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.48
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0049
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.49
      - key: INSTANCE_NUM
        value: '49'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.49
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.49
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0050
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.50
      - key: INSTANCE_NUM
        value: '50'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.50
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.50
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0051
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.51
      - key: INSTANCE_NUM
        value: '51'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.51
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.51
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0052
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.52
      - key: INSTANCE_NUM
        value: '52'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.52
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.52
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0053
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.53
      - key: INSTANCE_NUM
        value: '53'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.53
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.53
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0054
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.54
      - key: INSTANCE_NUM
        value: '54'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.54
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.54
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0055
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.55
      - key: INSTANCE_NUM
        value: '55'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.55
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.55
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0056
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.56
      - key: INSTANCE_NUM
        value: '56'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.56
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.56
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0057
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.57
      - key: INSTANCE_NUM
        value: '57'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.57
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.57
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0058
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.58
      - key: INSTANCE_NUM
        value: '58'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.58
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.58
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
- name: recipient0059
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: projects/multicast1/global/images/devimage5
      type: PERSISTENT
    machineType: zones/us-east4-c/machineTypes/c2d-highcpu-8
    metadata:
      items:
      - key: startup-script
        value: "#!/bin/bash -xe\n\necho \"Starting script...\"\n\nget_metadata() {\n\
          \  curl -s -H \"Metadata-Flavor: Google\" \\\n    \"http://metadata.google.internal/computeMetadata/v1/instance/attributes/$1\"\
          \n}\n\necho \"Fetching metadata\"\nIP_ADDR=$(get_metadata IP_ADDR)\nINSTANCE_NUM=$(get_metadata\
          \ INSTANCE_NUM)\nBKT_NAME=$(get_metadata BKT_NAME)\nRUN_MODE=$(get_metadata\
          \ RUN_MODE)\nCLOUD=$(get_metadata CLOUD)\nBRANCHING_FACTOR=$(get_metadata\
          \ BRANCHING_FACTOR)\nREDUNDANCY_FACTOR=$(get_metadata REDUNDANCY_FACTOR)\n\
          TOTAL_NON_REDUNDANT_PROXIES=$(get_metadata TOTAL_NON_REDUNDANT_PROXIES)\n\
          DUPLICATION_FACTOR=$(get_metadata DUPLICATION_FACTOR)\n\necho \"IP Address:\
          \ $IP_ADDR\"\necho \"Instance Number: $INSTANCE_NUM\"\necho \"Bucket Name:\
          \ $BKT_NAME\"\necho \"Run Mode: $RUN_MODE\"\necho \"Cloud: $CLOUD\"\necho\
          \ \"Branching Factor: $BRANCHING_FACTOR\"\necho \"Redundancy Factor: $REDUNDANCY_FACTOR\"\
          \necho \"Total Non-redundant Proxies: $TOTAL_NON_REDUNDANT_PROXIES\"\necho\
          \ \"Duplication Factor: $DUPLICATION_FACTOR\"\n\necho \"Downloading service\
          \ bundle\"\ncd /home/ubuntu\nsudo rm -rf dom-tenant-service/\nsudo mkdir\
          \ dom-tenant-service/\nsudo chmod 777 dom-tenant-service/\nsudo chown -R\
          \ root:root ./dom-tenant-service\n\ngcloud storage cp gs://cdm-templates-nyu-systems-multicast/bundled_proj.tar.gz\
          \ .\ntar -xzf bundled_proj.tar.gz -C dom-tenant-service/\nexport HOME=/root\n\
          \necho \"Capturing NIC info\"\ncat /sys/class/net/ens5/address > mac.txt\n\
          cat /sys/class/net/ens4/address > macsocket.txt\nip -o -4 addr show dev\
          \ ens5 | cut -d' ' -f7 | cut -d'/' -f1 > ip.txt\nip -o -4 addr show dev\
          \ ens4 | cut -d' ' -f7 | cut -d'/' -f1 > ipsocket.txt\n\necho \"Binding\
          \ ens5 to igb_uio\"\nsudo modprobe uio\nsudo modprobe igb_uio\nPCI_ADDR=$(ethtool\
          \ -i ens5 | grep bus-info | awk '{print $2}')\nip link set dev ens5 down\n\
          \ncommand -v dpdk-devbind.py >/dev/null 2>&1 || {\n  echo >&2 \"dpdk-devbind.py\
          \ not found! Aborting.\";\n  exit 1;\n}\n\nsudo dpdk-devbind.py --bind=igb_uio\
          \ $PCI_ADDR\nsudo dpdk-devbind.py --status\n\necho \"Setting up hugepages\"\
          \n[ -d /mnt/huge ] || sudo mkdir /mnt/huge\nmount | grep -q '/mnt/huge'\
          \ || sudo mount -t hugetlbfs -o pagesize=1G none /mnt/huge\ndpdk-hugepages.py\
          \ -s\n\necho \"Deploying ttcs\"\ncd dom-tenant-service/gcp-deploy\nsudo\
          \ chmod +x ../aws-deploy/stats_to_s3.sh\nsudo chmod +x ./deploy_ttcs.sh\n\
          sudo ./deploy_ttcs.sh ./assets/ttcs-agent.cfg $IP_ADDR\n\ncd ..\ncp ./../mac.txt\
          \ ./config/mac.txt\ncp ./../macsocket.txt ./config/macsocket.txt\ncp ./../ip.txt\
          \ ./config/ip.txt\ncp ./../ipsocket.txt ./config/ipsocket.txt\ncd ./src\n\
          \necho \"Compiling receiver\"\nmake multicast_receivers\n\necho \"Enabling\
          \ TCP BBR\"\nsudo modprobe tcp_bbr\nsudo sysctl -w net.ipv4.tcp_congestion_control=bbr\n\
          \necho \"Starting receiver\"\n./build/multicast_receivers $INSTANCE_NUM\
          \ $DUPLICATION_FACTOR $RUN_MODE $BRANCHING_FACTOR $REDUNDANCY_FACTOR $TOTAL_NON_REDUNDANT_PROXIES\
          \ $CLOUD\n"
      - key: IP_ADDR
        value: 10.1.3.59
      - key: INSTANCE_NUM
        value: '59'
      - key: BKT_NAME
        value: cdm-templates-nyu-systems-multicast
      - key: RUN_MODE
        value: dpdk
      - key: CLOUD
        value: gcp
      - key: BRANCHING_FACTOR
        value: '10'
      - key: REDUNDANCY_FACTOR
        value: '0'
      - key: TOTAL_NON_REDUNDANT_PROXIES
        value: '11'
      - key: DUPLICATION_FACTOR
        value: '1'
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: projects/multicast1/global/networks/multicast-management
      networkIP: 10.1.3.59
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-management
    - network: projects/multicast1/global/networks/multicast-service
      networkIP: 10.0.3.59
      networkPerformanceConfig:
        totalEgressBandwidthTier: TIER_1
      nicType: GVNIC
      stackType: IPV4_ONLY
      subnetwork: projects/multicast1/regions/us-east4/subnetworks/multicast-service
    serviceAccounts:
    - email: multicast-service-vm@multicast1.iam.gserviceaccount.com
      scopes:
      - https://www.googleapis.com/auth/cloud-platform
    zone: us-east4-c
  type: compute.v1.instance
